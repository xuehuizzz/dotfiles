## [下载地址](https://www.downloadkubernetes.com)

### <mark>什么是k8s</mark>

Kubernetes(简称k8s)是一个开源的容器编排平台, 旨在自动化应用程序容器的部署、扩展和管理. 它最初由 Google 开发, 现在由云原生计算基金会(CNCF)进行维护。k8s 主要解决了容器化应用在生产环境中的管理问题, 包括容器的调度、负载均衡、服务发现、自动化扩展、滚动更新等.
并且具有以下几个关键特性:

1. **自动化容器部署和管理**: 
    - k8s允许开发者和运维人员定义应用程序的容器化部署配置(例如，Pod、ReplicaSet、Deployment).
    - 它可以自动监控容器的状态，确保容器按照预期运行，如果出现故障，k8s 会自动重启容器.
2. **水平扩展和负载均衡**: 
    - k8s可以根据负载自动扩展容器的副本数量，并实现负载均衡.
    - 通过定义资源限制, k8s可以确保应用在负载增加时自动扩容, 负载降低时自动缩减
3. **自动化故障恢复**: 
    - k8s会自动替换失败的容器, 重新调度容器, 保证高可用性.
    - 它支持服务发现, 确保每个容器都能通过一致的 DNS 名称来访问其他容器服务
4. **声明式配置和自动化更新**: 
    - k8s支持声明式配置管理, 用户可以声明希望运行的最终状态, K8s 会自动确保集群达到这个状态.
    - 通过滚动更新和回滚机制，k8s使得更新和恢复应用变得更加容易
5. **多云和多环境支持**: 
    - k8s可以在各种环境中运行, 包括本地数据中心、公有云和私有云，支持跨多个云提供商的无缝迁移和混合云部署
6. **容器编排和集群管理**: 
    - k8s集群由多个节点组成，每个节点运行一个或多个容器. 集群通过k8s API 进行管理和控制

### <mark>k8s和docker swarm的区别</mark>

k8s和docker swarm都是容器编排工具, 旨在帮助管理容器化的部署、扩展和管理. 尽管有一些相同的功能, 但在设计理念、功能特性、复杂度和可扩展性方面有一些显著的区别.

1. **架构设计**:
    - k8s:
        - k8s是一个更为复杂和全面的容器编排系统, 拥有更强大的功能
        - 由多个组件组成,包括`API服务器、调度器、控制器管理器、etcd、kubelet、kube-proxy`等, 支持分布式部署和高可用
        - k8s采用`声明式`配置, 用户定义应用的期望状态, k8s会自动保证系统达到这个状态
    - docker swarm:
        - docker swarm是docker官方提供的容器编排解决方案, 设计更加简洁
        - swarm使用与docker原生CLI相同的工具和命令, 操作简单, 适合小规模应用和团队使用
        - 是docker引擎的原生扩展, 集成度较高
2. **功能**:
    - k8s:
        - 支持复杂的负载均衡、滚动更新、自动伸缩、健康检查、秘钥和配置管理等
        - 提供完整的服务发现功能, 支持多种存储方式. 支持跨多个数据中心和云平台的集群管理. 丰富的插件生态和社区管理
    - docker swarm
        - 支持基础的负载均衡、自动恢复、滚动更新等功能, 但不如k8s丰富灵活
        - 内置服务发现机制, 容器之间可以通过服务名称互相访问. 简化了网络和存储配置, 但不如k8s强大
3. **易用性**:
    - k8s:
        - 学习曲线较陡,特别是对于初学者, 因为其庞大的功能集和复杂的架构
        - 配置和操作通常需要更多的时间来掌握, 尤其是集群管理、调度策略、持久存储等方面
    - docker swarm:
        - 使用更简单, 适合docker生态的用户, 特别是对于已经熟悉docker命令的用户
        - 集成度较高, 直接基于docker的命令和API, 部署和管理比较直观
4. **可扩展性**:
    - k8s:
        - k8s是为大规模、复杂系统设计的，支持数千个节点和容器. 在集群规模、可扩展性、性能和高可用性方面表现优越
    - docker swarm:
        - 虽然可以支持多个节点和容器，但其可扩展性和性能相对 Kubernetes 较弱，适合中小规模的容器管理
5. **调度与自愈能力**:
    - k8s:
        - k8s提供强大的调度功能, 可以根据资源需求、节点标签、优先级等规则调度容器, 它还具有自愈能力, 可以根据节点或容器的故障自动重新调度任务
    - docker swarm:
        - swarm也支持容器的自愈机制，但其调度能力相对简单，灵活性和自定义选项较少
6. **支持的环境**:
    - k8s:
        - k8s是云原生的容器编排平台, 支持在本地数据中心、私有云、公共云等多种环境中运行, 具有高度的跨平台兼容性
    - docker swarm:
        - swarm主要依赖于docker 引擎, 更多的是用于本地环境或小型集群, 虽然也支持云平台, 但其跨平台兼容性不如k8s强
## kubelet
`kubelet是k8s中的一个核心组件，负责在每个工作节点（Node）上运行。它的主要任务是确保节点上的容器（由 Pod 定义）处于所期望的状态。kubelet充当k8s控制平面与工作节点之间的桥梁.`

# <font color=red>k8s资源理解</font>
1. ##  <mark>**Pod**</mark>
   - **单位大小**: 最小的可调度单位
   - **定义**: Pod是k8s中最小的部署单元, 通常表示一个或多个容器的集合, 这些容器共享网络和存储
   - **特点**: 
     - 包含一个或多个容器（通常是一个）
     - 共享同一个 IP 地址和端口空间
     - 是调度到节点上的实际执行单位
   - **应用场景**: 
     - 单个服务组件的基本运行实例，例如一个 Nginx Web 服务器
     - 用于短生命周期任务或批处理任务
   - **资源粒度**: 
     - Pod 直接消耗集群的计算资源（CPU、内存）
     - 单个 Pod 通常对应一个具体的服务实例

2. ##  <mark>**Deployment**</mark>
   - **单位大小**: 一组 Pods 的管理单位。
   - **定义**: Deployment 是一种控制器，用于管理 Pod 的声明式部署。它定义了所需的 Pod 副本数，并自动处理创建、更新和删除 Pod。
   - **特点**:
     - 提供副本管理，通过 replicas 字段控制 Pod 的数量。
     - 支持滚动更新、回滚等功能。
     - 提高了应用的高可用性和容错能力。
   - **应用场景**:
     - 运行需要多副本支持的应用，例如 Web 服务、API 服务。
     - 实现零停机时间的更新。
   - **资源粒度**:
     - 一个 Deployment 通常管理多个 Pod。
     - Deployment 会自动确保所需的 Pod 副本数在集群中运行。

3. ##  <mark>**Service**</mark>
   - **单位大小**: 访问和通信的抽象单位。
   - **定义**: Service 是一种网络抽象，提供稳定的网络入口以访问一组 Pod。
   - **特点**:
     - 使用标签选择器将流量分发给符合条件的 Pods。
     - 提供稳定的 IP 和 DNS 名称，隐藏 Pod 动态变化。
     - 有多种类型（ClusterIP、NodePort、LoadBalancer、ExternalName）。
   - **应用场景**:
     - 内部通信（使用 ClusterIP）或外部通信（使用 NodePort/LoadBalancer）。
     - 实现服务发现和负载均衡。
   - **资源粒度**:
     - Service 的作用是连接用户（或其他服务）和 Pod。
     - 它本身不直接消耗集群资源，但会依赖 kube-proxy 等组件进行流量转发


| 特性 | Pod | Deployment | Service |
| --- | --- | --- | --- |
| 粒度级别 | 最小的调度单位 | 管理多个 Pod 的部署单位 | 管理 Pod 的访问入口 |
| 作用范围 | 单个实例或容器集合 | 一组副本的生命周期管理 | 网络和服务访问的抽象层 |
| 管理功能 | 无需额外控制器 | 支持滚动更新、扩缩容等 | 提供负载均衡和服务发现 |
| 资源消耗 | 直接消耗资源 | 管理多个 Pod 的资源 | 本身消耗极少（仅负载转发） |
| 典型场景 | 批处理任务、单一容器运行 | 高可用应用、动态扩缩容 | 内部/外部通信，负载均衡 |
